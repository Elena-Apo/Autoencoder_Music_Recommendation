# Autocoder for Music Recommendation System (*processing*)

> Пет-проект по построению рекомендательной системы на основе нейросетевого автокодировщика.
> Цель — исследовать поведенческие паттерны пользователей и предложить персонализированные музыкальные рекомендации.
> Разработка продолжается, архитектура и подходы активно дорабатываются.

---

## Dataset Overview

- Источник: `yandex/yambda`, версия `flat-50m`, потоковая загрузка
- Размер исходного датасета: **28,277,654** записей
- Колонки:
    - `uid`: идентификатор пользователя
    - `item_id`: идентификатор трека
    - `played_ratio_pct`: процент прослушивания
    - `liked` / `disliked`: бинарные оценки
    - `interaction`: бинарный признак лайка (1 — лайк, 0 — нет)

---

## Data Preprocessing

-  Пропущенные значения: отсутствуют
-  Дубликаты: удалены
-  Разряженность:
    - Фактическая: `0.2128`
    - Логическая: `0.30`

### Filtration 

- Удалены треки с < 25 прослушиваниями
- Удалены пользователи без лайков
- Размер очищенного датасета: **39,510,922** записей

### Adding parameters 

| Признак         | Описание                          |
|----------------|-----------------------------------|
| `uid_enc`       | Закодированный ID пользователя    |
| `item_id_enc`   | Закодированный ID трека           |
| `item_id_freq`  | Частота появления трека           |

---

## Feature Scaling

Все признаки нормализованы (StandardScaler):

| Признак               | Mean     | Std      | Min      | Max      |
|-----------------------|----------|----------|----------|----------|
| `played_ratio_scaled` | ≈ 0      | 1.00     | -1.45    | 2.14     |
| `interaction_scaled`  | ≈ 0      | 1.00     | -2.82    | 1.70     |
| `uid_scaled`          | ≈ 0.50   | 0.29     | 0.00     | 1.00     |
| `item_scaled`         | ≈ 0.50   | 0.29     | 0.00     | 1.00     |

---

##  Model Architecture

Автокодировщик построен на Keras:

```text
Input → Dense(128) → BN → ReLU → Dropout
      → Dense(64) → BN → ReLU → Dropout
      → Dense(32) → Bottleneck
      → Dense(64) → BN → ReLU → Dropout
      → Dense(128) → BN → ReLU → Dropout
      → Output(4)
```

Всего параметров: 23,460
Обучаемых: 22,692
Необучаемых: 768

---

## Training 

| Epoch | Train Loss | Val Loss | Model Saved |
|-------|------------|----------|-------------|
| 1     | 0.0685     | 0.00308  | +           |
| 2     | 0.0181     | 0.00210  | +           |
| 3     | 0.0163     | 0.00210  | -           |
| 4     | 0.0154     | 0.00210  | -           |

> Модель сохраняется в `best_autoencoder.h5` при улучшении `val_loss`.

## Evaluation Results

После завершения обучения автокодировщик был протестирован на отложенной выборке `X_test`. 

Результат:

246944/246944 [==============================] - 228s 924us/step - loss: 0.0022
Test reconstruction loss: 0.0022

Низкое значение loss указывает на то, что модель хорошо справляется с восстановлением исходных признаков, что подтверждает её обучаемость и пригодность для извлечения скрытых паттернов.

## Reconstruction Error Analysis

После тестирования автокодировщика была проведена оценка ошибки реконструкции для каждого примера в тестовой выборке. 
Это позволяет понять, насколько точно модель восстанавливает входные данные и выявить потенциальные аномалии или сложные случаи.

### Static errors

- **Средняя ошибка реконструкции**: `0.002224`
- **Медианная ошибка**: `0.000688`
- **Минимальная ошибка**: `0.000000`
- **Максимальная ошибка**: `0.566495`

Дополнительно была сформирована сводная статистика по всем примерам:

| Показатель | Значение       |
|------------|----------------|
| Кол-во     | 7,902,185      |
| Среднее    | 0.002224       |
| STD        | 0.013088       |
| Min        | 0.000000       |
| 25%        | 0.000300       |
| 50%        | 0.000688       |
| 75%        | 0.001775       |
| Max        | 0.566495       |


Низкие значения средней и медианной ошибки подтверждают, что модель эффективно справляется с задачей реконструкции. 
Высокие значения в хвосте распределения могут указывать на редкие или сложные для модели случаи, которые стоит дополнительно изучить.

---

## Status
Проект находится в активной разработке. 

## In the future
- Визуализация ошибок
- Визуализация латентных признаков
- Интеграция с фронтендом
- Добавление шума и дообучение
